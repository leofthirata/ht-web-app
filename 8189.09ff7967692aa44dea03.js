(self.webpackChunkht_web_app=self.webpackChunkht_web_app||[]).push([[8189],{8189:(e,t,n)=>{"use strict";n.r(t),n.d(t,{HomePageModule:()=>_});var i=n(8583),o=n(3083),r=n(665),c=n(2316);function s(e,t,n,i){return new(n||(n=Promise))(function(o,r){function c(e){try{l(i.next(e))}catch(t){r(t)}}function s(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,s)}l((i=i.apply(e,t||[])).next())})}function l(e){for(var t=[],n=0,i=e.length;n<i;n++){var o=Number(e.charCodeAt(n)).toString(16);t.push(o)}return t.join("")}function a(e){for(var t=new ArrayBuffer(e.length/2),n=new Uint8Array(t),i=0;i<e.length/2;i++)n[i]=parseInt(e.substring(2*i,2*(i+1)),16);return t}function u(e,t){return function(e,t){var n=new e.constructor(e.length+t.length);return n.set(e,0),n.set(t,e.length),n}(new Uint8Array(e.buffer||e),new Uint8Array(t.buffer||t)).buffer}const h=[0,29,58,39,116,105,78,83,232,245,210,207,156,129,166,187,205,208,247,234,185,164,131,158,37,56,31,2,81,76,107,118,135,154,189,160,243,238,201,212,111,114,85,72,27,6,33,60,74,87,112,109,62,35,4,25,162,191,152,133,214,203,236,241,19,14,41,52,103,122,93,64,251,230,193,220,143,146,181,168,222,195,228,249,170,183,144,141,54,43,12,17,66,95,120,101,148,137,174,179,224,253,218,199,124,97,70,91,8,21,50,47,89,68,99,126,45,48,23,10,177,172,139,150,197,216,255,226,38,59,28,1,82,79,104,117,206,211,244,233,186,167,128,157,235,246,209,204,159,130,165,184,3,30,57,36,119,106,77,80,161,188,155,134,213,200,239,242,73,84,115,110,61,32,7,26,108,113,86,75,24,5,34,63,132,153,190,163,240,237,202,215,53,40,15,18,65,92,123,102,221,192,231,250,169,180,147,142,248,229,194,223,140,145,182,171,16,13,42,55,100,121,94,67,178,175,136,149,198,219,252,225,90,71,96,125,46,51,20,9,127,98,69,88,11,22,49,44,151,138,173,176,227,254,217,196],d=[117,165],g=[165,213];class f{constructor(e){this.m_mac=e,this.m_name=`${e.substring(e.length-4,e.length-2)}:${e.substring(e.length-2,e.length)}`}find(){return new Promise(e=>s(this,void 0,void 0,function*(){this.m_device=yield navigator.bluetooth.requestDevice({filters:[{name:`Hausenn ONE:${this.m_name}`},{services:[30117]}]}),this.m_device?(console.log("find true"),e(!0)):(console.log("find false"),e(!1))}))}connect(){return new Promise(e=>s(this,void 0,void 0,function*(){this.m_server=yield this.m_device.gatt.connect(),this.m_server?(e(!0),console.log("conn true")):(e(!1),console.log("conn false"))}))}disconnect(){return new Promise(e=>s(this,void 0,void 0,function*(){yield this.m_device.gatt.disconnect(),console.log("disc"),e(!0)}))}getService(){return new Promise(e=>s(this,void 0,void 0,function*(){this.m_service=yield this.m_device.gatt.getPrimaryService("000075a5-0000-1000-8000-00805f9b34fb"),console.log(this.m_service),this.m_service?(console.log("svc true"),e(!0)):(console.log("svc false"),e(!1))}))}getCharacteristics(){return new Promise(e=>s(this,void 0,void 0,function*(){this.m_readCharacteristic=yield this.m_service.getCharacteristic("3b274ac1-e910-4188-95aa-452018d93750"),this.m_writeCharacteristic=yield this.m_service.getCharacteristic("bf6d9667-bd7f-4e33-a608-21520546c82d"),console.log(this.m_readCharacteristic),console.log(this.m_writeCharacteristic),this.m_readCharacteristic&&this.m_writeCharacteristic?(console.log("chr true"),e(!0)):(console.log("chr false"),e(!1))}))}listen(){return new Promise(e=>s(this,void 0,void 0,function*(){console.log("listening");let t=yield this.m_readCharacteristic.readValue();console.log(t),e(!0)}))}_write(e,t){return new Promise(n=>s(this,void 0,void 0,function*(){for(let n=0;n<t/16;n++)yield this.m_writeCharacteristic.writeValue(e.slice(16*n,16*(n+1)))}))}scanWifi(e){return new Promise(e=>s(this,void 0,void 0,function*(){const t=this._createWifiConnCmd("Leo","12079412"),n=yield this._createRequest(t);console.log(n.value.byteLength),yield this._write(n.value,n.value.byteLength),e(!0)}))}_createWifiScanCmd(e){return[1,e]}_createWifiConnCmd(e,t){let n=function(e){let t=[];for(let n=0;n<e.length/2;n++)t[n]=parseInt(e.substring(2*n,2*n+2),16);return t}("02"+l(e)+"00"+l(t)+"00");for(let i=0;i<12;i++)n[n.length]=0;return n}_createFindMeCmd(){return[3,0]}_createRequest(e){return s(this,void 0,void 0,function*(){let t=function(e){let t=255;for(let n=0;n<e.length;n++)t=h[t^e[n]];return 255^t}(e),n=function(e){let t="";for(let n=0;n<e.length;n++)t+=e[n]<16?"0"+e[n].toString(16):e[n].toString(16);return t}(e)+(t<10?"0"+t.toString(16):t.toString(16));let i=yield function(e,t){return s(this,void 0,void 0,function*(){const t=yield window.crypto.subtle.importKey("raw",a("02E596CDAB2D81320A94BFD6D52BAFAE"),{name:"AES-CBC"},!1,["encrypt","decrypt"]),n=window.crypto.getRandomValues(new Uint8Array(16)),i=yield window.crypto.subtle.encrypt({name:"AES-CBC",iv:n},t,a(e));return{package:u(n,i),iv:n,enc:i}})}(n),o=Math.ceil(n.length/32)+"0",r=u(d,a(o));r=u(r,i.package),r=u(r,g);let c={value:r,header:d,iv:i.iv,data:e,crc:t,enc:i.enc,tail:g,key:"02E596CDAB2D81320A94BFD6D52BAFAE".toString()};return console.log("Request to be sent:"),console.log(c),c})}}class v{constructor(){}open(e){return this.m_uri=e,new Promise(t=>{this.m_ws=new WebSocket(e),this.m_ws.onopen=e=>{console.log("open:"+e),t(!0)},this.m_ws.onerror=e=>{console.log("error:"+e),t(!1)}})}send(e){return new Promise(t=>{this.m_ws.send(e),t(!0)})}ble(){(()=>{s(this,void 0,void 0,function*(){const e=yield navigator.bluetooth.requestDevice({acceptAllDevices:!0});console.log(e)})})()}}var m=n(639);const b=[{path:"",component:(()=>{class e{constructor(){}test(){return s(this,void 0,void 0,function*(){const e=new v;yield e.open("ws://localhost:8080"),e.send("bbbbbbbbbbbbbbbbbbb"),console.log("oi");const t=new f("7C9EBDD71678");yield t.find(),yield t.connect(),yield t.getService(),yield t.getCharacteristics(),yield t.scanWifi(15),console.log("oi")})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-home"]],decls:7,vars:1,consts:[[3,"translucent"],["padding",""],["ion-button","","full","",3,"click"]],template:function(e,t){1&e&&(m.TgZ(0,"ion-header",0),m.TgZ(1,"ion-toolbar"),m.TgZ(2,"ion-title"),m._uU(3," Websocket Chat "),m.qZA(),m.qZA(),m.qZA(),m.TgZ(4,"ion-content",1),m.TgZ(5,"button",2),m.NdJ("click",function(){return t.test()}),m._uU(6,"Start Websocket Client"),m.qZA(),m.qZA()),2&e&&m.Q6J("translucent",!0)},directives:[o.Gu,o.sr,o.wd,o.W2],styles:["#container[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}"]}),e})()}];let w=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.oAB({type:e}),e.\u0275inj=m.cJS({imports:[[c.Bz.forChild(b)],c.Bz]}),e})(),_=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.oAB({type:e}),e.\u0275inj=m.cJS({imports:[[i.ez,r.u5,o.Pc,w]]}),e})()}}]);